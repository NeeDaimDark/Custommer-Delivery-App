# OTP Password Reset - Visual Testing Guide

## ğŸ¬ Scenario: User Forgets Password

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   MOBILE APP                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  User is on Login Screen                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ğŸ“§ Email: ____________________         â”‚         â”‚
â”‚  â”‚ ğŸ”’ Password: ________________          â”‚         â”‚
â”‚  â”‚ [Login]     [Forgot Password?] â†â”€â”€ TAPS HERE   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              FORGOT PASSWORD SCREEN                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  ğŸ”                                  â”‚
â”‚           Reset Password                            â”‚
â”‚                                                      â”‚
â”‚  Enter your email and we'll send                    â”‚
â”‚  you a code to reset your password                  â”‚
â”‚                                                      â”‚
â”‚  ğŸ“§ Email: john.doe@example.com                      â”‚
â”‚  [Send Code]                                        â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
                 REQUEST SENT TO:
         POST /api/auth/forgot-password
         
         Body:
         {
           "email": "john.doe@example.com"
         }
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BACKEND                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  âœ“ Receive email: john.doe@example.com             â”‚
â”‚  âœ“ Find customer in database                        â”‚
â”‚  âœ“ Generate OTP: 482016                             â”‚
â”‚  âœ“ Set expiration: 10 minutes from now              â”‚
â”‚  âœ“ Save to database                                 â”‚
â”‚  âœ“ Send email with OTP                              â”‚
â”‚  âœ“ Return success response                          â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   EMAIL RECEIVED                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  From: Food Delivery App <noreply@...>             â”‚
â”‚  Subject: Your verification code                    â”‚
â”‚                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Hi John,                              â”‚         â”‚
â”‚  â”‚                                        â”‚         â”‚
â”‚  â”‚  Your verification code is:            â”‚         â”‚
â”‚  â”‚                                        â”‚         â”‚
â”‚  â”‚          482016                        â”‚         â”‚
â”‚  â”‚                                        â”‚         â”‚
â”‚  â”‚  This code expires in 10 minutes       â”‚         â”‚
â”‚  â”‚                                        â”‚         â”‚
â”‚  â”‚  If you didn't request this code,      â”‚         â”‚
â”‚  â”‚  please ignore this email              â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ENTER VERIFICATION CODE SCREEN             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  We have sent a code to your Email                  â”‚
â”‚  john.doe@example.com                               â”‚
â”‚                                                      â”‚
â”‚  Please check your email to reset                   â”‚
â”‚  your password                                      â”‚
â”‚                                                      â”‚
â”‚  [4][8][2][0][1][6]   â† Enter 6-digit code         â”‚
â”‚                                                      â”‚
â”‚  [Next]                                             â”‚
â”‚                                                      â”‚
â”‚  Didn't Receive? Click Here                         â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
                 REQUEST SENT TO:
       POST /api/auth/verify-otp-reset
       
       Body:
       {
         "email": "john.doe@example.com",
         "otpCode": "482016"
       }
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BACKEND                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  âœ“ Receive email & OTP                              â”‚
â”‚  âœ“ Find customer in database                        â”‚
â”‚  âœ“ Check if OTP matches                             â”‚
â”‚  âœ“ Check if OTP not expired (< 10 min)              â”‚
â”‚  âœ“ Generate reset token (15 min validity)           â”‚
â”‚  âœ“ Save reset token to database                     â”‚
â”‚  âœ“ Clear OTP (prevent reuse)                        â”‚
â”‚  âœ“ Return reset token to app                        â”‚
â”‚                                                      â”‚
â”‚  Response:                                           â”‚
â”‚  {                                                   â”‚
â”‚    "success": true,                                 â”‚
â”‚    "resetToken": "abc123def456...",                 â”‚
â”‚    "message": "OTP verified successfully"           â”‚
â”‚  }                                                   â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          CREATE NEW PASSWORD SCREEN                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  âœ… Code Verified!                                  â”‚
â”‚                                                      â”‚
â”‚  Please enter your new password                     â”‚
â”‚                                                      â”‚
â”‚  New Password: [________________]  ğŸ”               â”‚
â”‚  Confirm Password: [________________]  ğŸ”           â”‚
â”‚                                                      â”‚
â”‚  [Next â†’]                                           â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
                 REQUEST SENT TO:
          POST /api/auth/reset-password
          
          Body:
          {
            "token": "abc123def456...",
            "newPassword": "MyNewPassword123"
          }
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BACKEND                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  âœ“ Receive token & new password                     â”‚
â”‚  âœ“ Validate token hasn't expired (< 15 min)         â”‚
â”‚  âœ“ Hash new password with bcrypt                    â”‚
â”‚  âœ“ Update password in database                      â”‚
â”‚  âœ“ Clear reset token (prevent reuse)                â”‚
â”‚  âœ“ Return success message                           â”‚
â”‚                                                      â”‚
â”‚  Response:                                           â”‚
â”‚  {                                                   â”‚
â”‚    "success": true,                                 â”‚
â”‚    "message": "Password reset successfully!"        â”‚
â”‚  }                                                   â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              SUCCESS SCREEN                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  âœ… Password Changed Successfully!                  â”‚
â”‚                                                      â”‚
â”‚  You can now login with your new password           â”‚
â”‚                                                      â”‚
â”‚  [Go to Login]                                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“â†“â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              LOGIN SCREEN AGAIN                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                      â”‚
â”‚  ğŸ“§ Email: john.doe@example.com                      â”‚
â”‚  ğŸ”’ Password: MyNewPassword123                       â”‚
â”‚  [Login]                                            â”‚
â”‚                                                      â”‚
â”‚  âœ… AUTHENTICATION SUCCESSFUL!                      â”‚
â”‚                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request/Response Sequence

### **Request 1: Forgot Password**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER INTERFACE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  Input: john.doe@example.com         â”‚
â”‚  Click: [Send OTP]                   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ HTTP POST â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND API                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Endpoint: POST /api/auth/           â”‚
â”‚             forgot-password          â”‚
â”‚                                      â”‚
â”‚  Request Body:                       â”‚
â”‚  {                                   â”‚
â”‚    "email": "john.doe@example.com"  â”‚
â”‚  }                                   â”‚
â”‚                                      â”‚
â”‚  Processing:                         â”‚
â”‚  1. Validate email format âœ“          â”‚
â”‚  2. Find customer in DB âœ“            â”‚
â”‚  3. Generate OTP âœ“                   â”‚
â”‚  4. Save OTP + expiry âœ“              â”‚
â”‚  5. Send email âœ“                     â”‚
â”‚                                      â”‚
â”‚  Response (200 OK):                  â”‚
â”‚  {                                   â”‚
â”‚    "success": true,                  â”‚
â”‚    "message": "OTP sent to your...", â”‚
â”‚    "email": "john.doe@example.com"  â”‚
â”‚  }                                   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ Email Sent â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  EMAIL SERVICE (Brevo)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  ğŸ“§ Email sent to:                   â”‚
â”‚     john.doe@example.com             â”‚
â”‚                                      â”‚
â”‚  Subject: Your verification code     â”‚
â”‚                                      â”‚
â”‚  Code: 482016                        â”‚
â”‚  Expires: 10 minutes                 â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Request 2: Verify OTP**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER INTERFACE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  Input OTP: 482016                   â”‚
â”‚  Click: [Next]                       â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ HTTP POST â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND API                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Endpoint: POST /api/auth/           â”‚
â”‚             verify-otp-reset         â”‚
â”‚                                      â”‚
â”‚  Request Body:                       â”‚
â”‚  {                                   â”‚
â”‚    "email": "john.doe@example.com", â”‚
â”‚    "otpCode": "482016"               â”‚
â”‚  }                                   â”‚
â”‚                                      â”‚
â”‚  Processing:                         â”‚
â”‚  1. Validate inputs âœ“                â”‚
â”‚  2. Find customer âœ“                  â”‚
â”‚  3. Check OTP match âœ“                â”‚
â”‚  4. Check not expired âœ“              â”‚
â”‚  5. Generate token âœ“                 â”‚
â”‚  6. Clear OTP âœ“                      â”‚
â”‚                                      â”‚
â”‚  Response (200 OK):                  â”‚
â”‚  {                                   â”‚
â”‚    "success": true,                  â”‚
â”‚    "resetToken": "abc123...",        â”‚
â”‚    "message": "OTP verified..."      â”‚
â”‚  }                                   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Request 3: Reset Password**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  USER INTERFACE                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                      â”‚
â”‚  Input Password: MyNewPassword123    â”‚
â”‚  Click: [Reset Password]             â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ HTTP POST â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BACKEND API                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Endpoint: POST /api/auth/           â”‚
â”‚             reset-password           â”‚
â”‚                                      â”‚
â”‚  Request Body:                       â”‚
â”‚  {                                   â”‚
â”‚    "token": "abc123...",             â”‚
â”‚    "newPassword": "MyNewPassword123" â”‚
â”‚  }                                   â”‚
â”‚                                      â”‚
â”‚  Processing:                         â”‚
â”‚  1. Validate token âœ“                 â”‚
â”‚  2. Check not expired âœ“              â”‚
â”‚  3. Hash password âœ“                  â”‚
â”‚  4. Update DB âœ“                      â”‚
â”‚  5. Clear token âœ“                    â”‚
â”‚                                      â”‚
â”‚  Response (200 OK):                  â”‚
â”‚  {                                   â”‚
â”‚    "success": true,                  â”‚
â”‚    "message": "Password reset..."    â”‚
â”‚  }                                   â”‚
â”‚                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“
        âœ… SUCCESS!
        User can now login
        with new password
```

---

## â±ï¸ Timeline & Expiration

```
TIME 0:00 â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚  User clicks "Forgot Password"
â”‚  â”‚
â”‚  â””â”€ [BACKEND]
â”‚     â”‚
â”‚     â”œâ”€ Generate OTP: 482016
â”‚     â”œâ”€ Save OTP to database
â”‚     â””â”€ Send email
â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚  User checks email & sees OTP
â”‚  â”‚
â”‚  â””â”€ [TIME WINDOW: 10 MINUTES]
â”‚     â”‚
â”‚     â”œâ”€ 0:01 â”€â”€â”€ User opens email âœ“
â”‚     â”œâ”€ 0:02 â”€â”€â”€ User sees OTP âœ“
â”‚     â”œâ”€ 0:03 â”€â”€â”€ User enters OTP âœ“
â”‚     â”‚
â”‚     â”œâ”€ [BACKEND]
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Verify OTP âœ“
â”‚     â”‚  â”œâ”€ Generate reset token
â”‚     â”‚  â”œâ”€ Save reset token
â”‚     â”‚  â””â”€ Clear OTP
â”‚     â”‚
â”‚     â”œâ”€ 0:04 â”€â”€â”€ Reset token received âœ“
â”‚     â”‚
â”‚     â””â”€ â±ï¸ OTP EXPIRES AT 10:00 (even if not used)
â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚  User sees password reset screen
â”‚  â”‚
â”‚  â””â”€ [TIME WINDOW: 15 MINUTES]
â”‚     â”‚
â”‚     â”œâ”€ 0:05 â”€â”€â”€ User navigates to new password
â”‚     â”œâ”€ 0:06 â”€â”€â”€ User enters new password
â”‚     â”œâ”€ 0:07 â”€â”€â”€ User confirms password
â”‚     â”œâ”€ 0:08 â”€â”€â”€ User clicks "Reset Password" âœ“
â”‚     â”‚
â”‚     â”œâ”€ [BACKEND]
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Verify reset token âœ“
â”‚     â”‚  â”œâ”€ Hash new password
â”‚     â”‚  â”œâ”€ Update database
â”‚     â”‚  â””â”€ Clear reset token
â”‚     â”‚
â”‚     â”œâ”€ 0:09 â”€â”€â”€ Password reset successful âœ“
â”‚     â”‚
â”‚     â””â”€ â±ï¸ RESET TOKEN EXPIRES AT 15:00 (even if used)
â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”‚
â”‚  User ready to login
â”‚  â”‚
â”‚  â””â”€ [LOGIN WITH NEW CREDENTIALS]
â”‚     â”‚
â”‚     â”œâ”€ Email: john.doe@example.com
â”‚     â”œâ”€ Password: MyNewPassword123
â”‚     â”‚
â”‚     â”œâ”€ [BACKEND]
â”‚     â”‚  â”‚
â”‚     â”‚  â”œâ”€ Verify credentials
â”‚     â”‚  â””â”€ Return tokens
â”‚     â”‚
â”‚     â””â”€ âœ… LOGGED IN!
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

---

## ğŸš¨ Error Scenarios with Responses

### **Scenario 1: Email Not Found**
```
Request:
POST /api/auth/forgot-password
{ "email": "nonexistent@example.com" }

Response (404):
{
  "success": false,
  "message": "Customer not found"
}

Action: User must register first
```

### **Scenario 2: Wrong OTP**
```
Request:
POST /api/auth/verify-otp-reset
{ 
  "email": "john.doe@example.com",
  "otpCode": "999999"  // â† Wrong code
}

Response (400):
{
  "success": false,
  "message": "Invalid or expired OTP"
}

Action: User must check email again and enter correct code
```

### **Scenario 3: OTP Expired**
```
Situation: User waits 11 minutes before entering OTP

Request:
POST /api/auth/verify-otp-reset
{
  "email": "john.doe@example.com",
  "otpCode": "482016"
}

Response (400):
{
  "success": false,
  "message": "Invalid or expired OTP"
}

Action: User must request new OTP
```

### **Scenario 4: Reset Token Expired**
```
Situation: User waits 16 minutes after OTP verification

Request:
POST /api/auth/reset-password
{
  "token": "abc123...",
  "newPassword": "NewPassword123"
}

Response (400):
{
  "success": false,
  "message": "Invalid or expired reset token. Please start password reset again."
}

Action: User must start from Step 1 again
```

---

## ğŸ“Š Database State Changes

### **Before Password Reset**
```
Customer {
  _id: "674abc123...",
  email: "john.doe@example.com",
  password: "$2b$10$hashedOldPassword...",
  otpCode: null,
  otpExpires: null,
  resetPasswordToken: null,
  resetPasswordExpires: null
}
```

### **After Step 1 (OTP Sent)**
```
Customer {
  _id: "674abc123...",
  email: "john.doe@example.com",
  password: "$2b$10$hashedOldPassword...",  // â† Unchanged
  otpCode: "482016",  // â† NEW
  otpExpires: 2024-01-15T10:10:00Z,  // â† NEW
  resetPasswordToken: null,
  resetPasswordExpires: null
}
```

### **After Step 2 (OTP Verified)**
```
Customer {
  _id: "674abc123...",
  email: "john.doe@example.com",
  password: "$2b$10$hashedOldPassword...",  // â† Unchanged
  otpCode: null,  // â† CLEARED
  otpExpires: null,  // â† CLEARED
  resetPasswordToken: "$2b$10$hashedResetToken...",  // â† NEW
  resetPasswordExpires: 2024-01-15T10:15:00Z  // â† NEW
}
```

### **After Step 3 (Password Reset)**
```
Customer {
  _id: "674abc123...",
  email: "john.doe@example.com",
  password: "$2b$10$hashedNewPassword...",  // â† UPDATED!
  otpCode: null,
  otpExpires: null,
  resetPasswordToken: null,  // â† CLEARED
  resetPasswordExpires: null  // â† CLEARED
}
```

---

## ğŸ¯ Summary

```
3-Step Process:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Step 1: SEND OTP
Input â†’ Email address
Process â†’ Generate & send 6-digit OTP (10 min validity)
Output â†’ Success confirmation

Step 2: VERIFY OTP
Input â†’ Email + 6-digit OTP code
Process â†’ Validate OTP, generate reset token (15 min)
Output â†’ Reset token

Step 3: RESET PASSWORD
Input â†’ Reset token + new password
Process â†’ Hash password, update database
Output â†’ Success message

Result: User can login with new password âœ…
```

---

**Your OTP password reset flow is complete and secure!** ğŸ”
